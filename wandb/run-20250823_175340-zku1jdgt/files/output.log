INFO: Starting training:
        Epochs:          40
        Batch size:      32
        Learning rate:   1e-05
        Training size:   465
        Validation size: 5
        Checkpoints:     True
        Device:          cuda
        Images scaling:  0.5
        Mixed Precision: True
Epoch 1/40:  14%|██████████████████       INFO: Validation Dice score: 0.0                                                                          | 64/465 [00:01<00:09, 43.59img/s, loss (batch)=2.19]
Epoch 1/40:  28%|█████████████████████████INFO: Validation Dice score: 0.0                                                                          | 128/465 [00:03<00:08, 39.52img/s, loss (batch)=2.2]
Epoch 1/40:  41%|█████████████████████████INFO: Validation Dice score: 0.0                                                                         | 192/465 [00:04<00:06, 44.89img/s, loss (batch)=1.92]
Epoch 1/40:  55%|█████████████████████████INFO: Validation Dice score: 0.0██████████████▌                                                          | 256/465 [00:06<00:04, 47.47img/s, loss (batch)=1.89]
Epoch 1/40:  69%|█████████████████████████INFO: Validation Dice score: 0.0████████████████████████████████▍                                        | 320/465 [00:07<00:03, 48.32img/s, loss (batch)=1.92]
Epoch 1/40:  83%|█████████████████████████INFO: Validation Dice score: 0.0██████████████████████████████████████████████████▎                      | 384/465 [00:08<00:01, 48.69img/s, loss (batch)=1.79]
Epoch 1/40:  96%|█████████████████████████INFO: Validation Dice score: 0.0████████████████████████████████████████████████████████████████████▏    | 448/465 [00:10<00:00, 48.79img/s, loss (batch)=1.81]
Epoch 1/40: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:10<00:00, 42.95img/s, loss (batch)=1.81]
INFO: Checkpoint 1 saved!
Epoch 2/40:   7%|█████████                INFO: Validation Dice score: 0.0                                                                          | 32/465 [00:00<00:06, 64.75img/s, loss (batch)=1.74]
Epoch 2/40:  21%|█████████████████████████INFO: Validation Dice score: 0.0                                                                          | 96/465 [00:01<00:07, 52.19img/s, loss (batch)=1.71]
Epoch 2/40:  34%|█████████████████████████INFO: Validation Dice score: 0.0                                                                         | 160/465 [00:03<00:06, 50.62img/s, loss (batch)=1.78]
Epoch 2/40:  48%|█████████████████████████INFO: Validation Dice score: 0.0█████▌                                                                   | 224/465 [00:04<00:04, 49.89img/s, loss (batch)=1.84]
Epoch 2/40:  62%|█████████████████████████INFO: Validation Dice score: 0.0███████████████████████▌                                                 | 288/465 [00:05<00:03, 49.56img/s, loss (batch)=1.78]
Epoch 2/40:  76%|█████████████████████████INFO: Validation Dice score: 0.0██████████████████████████████████████████▏                               | 352/465 [00:07<00:02, 49.77img/s, loss (batch)=1.7]
Epoch 2/40:  89%|█████████████████████████INFO: Validation Dice score: 0.0███████████████████████████████████████████████████████████▎             | 416/465 [00:08<00:00, 49.64img/s, loss (batch)=1.66]
Epoch 2/40: 100%|█████████████████████████INFO: Validation Dice score: 0.0█████████████████████████████████████████████████████████████████████████| 465/465 [00:09<00:00, 47.29img/s, loss (batch)=1.66]
Epoch 2/40: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:10<00:00, 45.90img/s, loss (batch)=1.66]
INFO: Checkpoint 2 saved!
Epoch 3/40:  14%|██████████████████       INFO: Validation Dice score: 0.0                                                                          | 64/465 [00:01<00:06, 63.81img/s, loss (batch)=1.72]
Epoch 3/40:  28%|█████████████████████████INFO: Validation Dice score: 0.0                                                                         | 128/465 [00:02<00:06, 52.64img/s, loss (batch)=1.68]
Epoch 3/40:  41%|█████████████████████████INFO: Validation Dice score: 0.0                                                                          | 192/465 [00:03<00:05, 46.38img/s, loss (batch)=1.7]
Epoch 3/40:  55%|█████████████████████████INFO: Validation Dice score: 0.0██████████████▌                                                          | 256/465 [00:05<00:05, 39.51img/s, loss (batch)=1.69]
Epoch 3/40:  69%|█████████████████████████INFO: Validation Dice score: 0.0████████████████████████████████▍                                        | 320/465 [00:07<00:04, 35.90img/s, loss (batch)=1.76]
Epoch 3/40:  83%|█████████████████████████INFO: Validation Dice score: 0.0██████████████████████████████████████████████████▎                      | 384/465 [00:09<00:02, 36.23img/s, loss (batch)=1.71]
Epoch 3/40:  96%|█████████████████████████INFO: Validation Dice score: 0.0████████████████████████████████████████████████████████████████████▏    | 448/465 [00:11<00:00, 41.94img/s, loss (batch)=1.74]
Epoch 3/40: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:11<00:00, 39.24img/s, loss (batch)=1.67]
INFO: Checkpoint 3 saved!
Epoch 4/40:   7%|█████████                INFO: Validation Dice score: 0.0                                                                          | 32/465 [00:00<00:06, 63.20img/s, loss (batch)=1.66]
Epoch 4/40:  21%|█████████████████████████INFO: Validation Dice score: 0.0                                                                          | 96/465 [00:01<00:07, 51.81img/s, loss (batch)=1.67]
Epoch 4/40:  34%|█████████████████████████INFO: Validation Dice score: 0.0                                                                         | 160/465 [00:03<00:06, 46.21img/s, loss (batch)=1.67]
Epoch 4/40:  48%|█████████████████████████INFO: Validation Dice score: 0.0██████                                                                    | 224/465 [00:05<00:06, 38.70img/s, loss (batch)=1.7]
Epoch 4/40:  62%|█████████████████████████INFO: Validation Dice score: 0.0███████████████████████▌                                                 | 288/465 [00:07<00:04, 36.03img/s, loss (batch)=1.68]
Epoch 4/40:  76%|█████████████████████████INFO: Validation Dice score: 0.0█████████████████████████████████████████▍                               | 352/465 [00:09<00:03, 34.84img/s, loss (batch)=1.78]
Epoch 4/40:  89%|█████████████████████████INFO: Validation Dice score: 0.0███████████████████████████████████████████████████████████▎             | 416/465 [00:11<00:01, 34.38img/s, loss (batch)=1.69]
Epoch 4/40: 100%|█████████████████████████INFO: Validation Dice score: 0.0█████████████████████████████████████████████████████████████████████████| 465/465 [00:13<00:00, 32.32img/s, loss (batch)=1.65]
Epoch 4/40: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:13<00:00, 33.58img/s, loss (batch)=1.65]
INFO: Checkpoint 4 saved!
Epoch 5/40:  14%|██████████████████       INFO: Validation Dice score: 0.0                                                                          | 64/465 [00:01<00:08, 49.46img/s, loss (batch)=1.68]
Epoch 5/40:  28%|█████████████████████████INFO: Validation Dice score: 0.0                                                                         | 128/465 [00:03<00:08, 37.65img/s, loss (batch)=1.73]
Epoch 5/40:  41%|█████████████████████████INFO: Validation Dice score: 0.0                                                                         | 192/465 [00:05<00:07, 34.92img/s, loss (batch)=1.75]
Epoch 5/40:  55%|█████████████████████████INFO: Validation Dice score: 0.0██████████████▌                                                          | 256/465 [00:07<00:06, 34.50img/s, loss (batch)=1.66]
Epoch 5/40:  69%|█████████████████████████INFO: Validation Dice score: 0.0█████████████████████████████████▏                                        | 320/465 [00:09<00:04, 33.95img/s, loss (batch)=1.7]
Epoch 5/40:  83%|█████████████████████████INFO: Validation Dice score: 0.0██████████████████████████████████████████████████▎                      | 384/465 [00:11<00:02, 33.46img/s, loss (batch)=1.74]
Epoch 5/40:  96%|█████████████████████████INFO: Validation Dice score: 0.0████████████████████████████████████████████████████████████████████▏    | 448/465 [00:13<00:00, 34.17img/s, loss (batch)=1.66]
Epoch 5/40: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:14<00:00, 32.04img/s, loss (batch)=1.69]
INFO: Checkpoint 5 saved!
Epoch 6/40:   7%|█████████                INFO: Validation Dice score: 0.0                                                                          | 32/465 [00:00<00:09, 47.37img/s, loss (batch)=1.67]
Epoch 6/40:  21%|█████████████████████████INFO: Validation Dice score: 0.0                                                                          | 96/465 [00:02<00:10, 35.83img/s, loss (batch)=1.74]
Epoch 6/40:  21%|███████████████████████████                                                                                                        | 96/465 [00:03<00:13, 27.37img/s, loss (batch)=1.74]
Traceback (most recent call last):
  File "C:\Users\Nishaoqing\Desktop\UNet\Pytorch-UNet\train.py", line 285, in <module>
    train_model(
  File "C:\Users\Nishaoqing\Desktop\UNet\Pytorch-UNet\train.py", line 146, in train_model
    for batch in train_loader:
  File "C:\Users\Nishaoqing\AppData\Local\Programs\Python\Python311\Lib\site-packages\torch\utils\data\dataloader.py", line 701, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\Nishaoqing\AppData\Local\Programs\Python\Python311\Lib\site-packages\torch\utils\data\dataloader.py", line 757, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Nishaoqing\AppData\Local\Programs\Python\Python311\Lib\site-packages\torch\utils\data\_utils\fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Nishaoqing\AppData\Local\Programs\Python\Python311\Lib\site-packages\torch\utils\data\_utils\fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "C:\Users\Nishaoqing\Desktop\UNet\Pytorch-UNet\train.py", line 33, in __getitem__
    img, msk = self.base[idx]
               ~~~~~~~~~^^^^^
  File "C:\Users\Nishaoqing\Desktop\UNet\Pytorch-UNet\train_gaps.py", line 88, in __getitem__
    img = self.img_tf(img)  # [3,400,400], 0..1
          ^^^^^^^^^^^^^^^^
  File "C:\Users\Nishaoqing\AppData\Local\Programs\Python\Python311\Lib\site-packages\torchvision\transforms\transforms.py", line 95, in __call__
    img = t(img)
          ^^^^^^
  File "C:\Users\Nishaoqing\AppData\Local\Programs\Python\Python311\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Nishaoqing\AppData\Local\Programs\Python\Python311\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Nishaoqing\AppData\Local\Programs\Python\Python311\Lib\site-packages\torchvision\transforms\transforms.py", line 354, in forward
    return F.resize(img, self.size, self.interpolation, self.max_size, self.antialias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Nishaoqing\AppData\Local\Programs\Python\Python311\Lib\site-packages\torchvision\transforms\functional.py", line 477, in resize
    return F_pil.resize(img, size=output_size, interpolation=pil_interpolation)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Nishaoqing\AppData\Local\Programs\Python\Python311\Lib\site-packages\torchvision\transforms\_functional_pil.py", line 250, in resize
    return img.resize(tuple(size[::-1]), interpolation)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Nishaoqing\AppData\Local\Programs\Python\Python311\Lib\site-packages\PIL\Image.py", line 2115, in resize
    return self._new(self.im.resize(size, resample, box))
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt